/* Code syntax highlighting theme */
@import './code-theme.css';

/* Shared Tiptap Editor Styles extracted from legacy PostContent.vue */
.post-content { @apply text-foreground; }
.post-content .ProseMirror { @apply focus:outline-none border-none ring-none shadow-none; }
.post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection { @apply bg-[#000] p-2 transition-all; }
.post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection { @apply color-white transition-all; }
.post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection p { @apply color-white transition-all; }
.light .post-content .ProseMirror.ProseMirror-hideselection p.horizontal-card__text::selection { @apply bg-black; }
.dark .post-content .ProseMirror.ProseMirror-hideselection p.horizontal-card__text::selection { @apply bg-white; }
.dark .post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection { @apply bg-[#F5E5E1]; }
.dark .post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection { @apply color-black transition-all; }
.dark .post-content .ProseMirror.ProseMirror-noderangeselection.ProseMirror-hideselection p { @apply color-black transition-all; }
.dark .post-content .ProseMirror.ProseMirror-hideselection .audio-container .title::selection,
.dark .post-content .ProseMirror.ProseMirror-hideselection .audio-container .time-left::selection,
.dark .post-content .ProseMirror.ProseMirror-hideselection .audio-container .time-right::selection { @apply color-white; }
.light .post-content .ProseMirror.ProseMirror-hideselection .audio-container .title::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection .audio-container .time-left::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection div::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection span::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection label::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection strong::selection,
.light .post-content .ProseMirror.ProseMirror-hideselection .audio-container .time-right::selection { @apply color-black; }

/* Placeholder handling */
.post-content .ProseMirror [data-placeholder].is-editor-empty,
.post-content .ProseMirror [data-placeholder].is-empty { position: relative; }
.post-content .ProseMirror p[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror p[data-placeholder].is-empty::after,
.post-content .ProseMirror h1[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror h1[data-placeholder].is-empty::after,
.post-content .ProseMirror h2[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror h2[data-placeholder].is-empty::after,
.post-content .ProseMirror h3[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror h3[data-placeholder].is-empty::after,
.post-content .ProseMirror h4[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror h4[data-placeholder].is-empty::after,
.post-content .ProseMirror li[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror li[data-placeholder].is-empty::after,
.post-content .ProseMirror blockquote[data-placeholder].is-editor-empty::after,
.post-content .ProseMirror blockquote[data-placeholder].is-empty::after {
  content: attr(data-placeholder);
  color: #adb5bd;
  position: absolute;
  left: 0.125rem;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
  opacity: 0.9;
  white-space: pre-wrap;
  z-index: 0;
}

/* Typography */
.post-content .ProseMirror h1 { @apply text-4xl font-serif font-800 mt-12 mb-6 leading-tight; }
.post-content .ProseMirror h2 { @apply text-3xl font-serif font-800 mt-10 mb-5 leading-snug; }
.post-content .ProseMirror h3 { @apply text-2xl font-serif font-500 mt-8 mb-4; }
.post-content .ProseMirror h4 { @apply text-xl font-serif font-500 mt-6 mb-3; }
.post-content .ProseMirror p { @apply text-base md:text-lg leading-relaxed mb-8 text-foreground/80 font-text font-500; }
.post-content .ProseMirror ul[data-type="taskList"] p { @apply mb-0; line-height: 1rem; }
.post-content .ProseMirror a { @apply text-primary hover:text-primary/80 underline decoration-2 underline-offset-2 transition-colors; }
.post-content .ProseMirror strong { @apply font-800 text-foreground; }
.post-content .ProseMirror em { @apply italic; }
.post-content .ProseMirror blockquote { @apply border-l-4 border-primary/40 pl-6 py-4 my-8 italic text-lg md:text-xl text-slate-500 dark:text-slate-400 bg-muted/20 rounded-r-lg font-text; }
.post-content .ProseMirror blockquote p { @apply mb-0; }
.post-content .ProseMirror ul, .post-content .ProseMirror ol { @apply my-6 pl-6 space-y-2; }
.post-content .ProseMirror ul { @apply list-disc; }
.post-content .ProseMirror ol { @apply list-decimal; }
.post-content .ProseMirror li { @apply text-base md:text-lg leading-relaxed text-foreground/90 font-text; }
.post-content .ProseMirror li > p { @apply mb-2; }
.post-content .ProseMirror code { @apply bg-muted px-2 py-1 rounded text-sm font-mono text-primary; }
.post-content .ProseMirror pre { @apply bg-muted rounded-lg overflow-x-auto my-6; }
.post-content .ProseMirror pre code { @apply bg-transparent p-0 text-foreground; }
.post-content .ProseMirror img { @apply w-full h-auto rounded-xl my-8 shadow-lg cursor-pointer; }

/* Use General Sans for body content in both editor and viewer */
.post-content .ProseMirror td,
.post-content .ProseMirror th {
  @apply font-text;
}

/* Highlight selected image node */
.post-content img.ProseMirror-selectednode {
  outline: 2px solid var(--un-primary-color, #3b82f6);
  outline-offset: 2px;
  border-radius: 6px;
  box-shadow: 0 0 0 2px rgba(0,0,0,0.15);
  transition: outline-offset 0.2s ease, box-shadow 0.2s ease;
}
/* Figure/caption (node view) styling */
.ProseMirror figure.image-figure { margin: 2.5rem 0; text-align: center; }
.ProseMirror figure.image-figure img { display: block; margin: 0 auto; }
.ProseMirror figure.image-figure figcaption.image-caption { font-size: 0.7rem; line-height: 1.1; color: var(--un-muted-color, #6b7280); margin-top: 0.5rem; font-style: italic; }

/* Full-bleed images (editor/read-only ProseMirror context) */
.ProseMirror figure.image-figure--full-bleed {
  width: 100vw;
  max-width: none;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-inline: 1rem;
  box-sizing: border-box;
}
.ProseMirror figure.image-figure--full-bleed img {
  width: 100%;
  max-width: none;
  margin: 0;
  border-radius: 0;
}

.dark .ProseMirror figure.image-figure figcaption.image-caption { color: var(--un-muted-color, #9ca3af); }
.post-content .ProseMirror hr { @apply my-12 border-t-none border-b border-border h-[16px] bg-transparent transition-colors duration-800 ease-in-out; }
.post-content .ProseMirror hr:hover { @apply border-blue; }
.post-content .ProseMirror hr.separator { @apply; }
.post-content .ProseMirror hr.separator--dashed { @apply border-border/60 border-b-dashed opacity-80; }

/* Task list */
.post-content .ProseMirror ul[data-type="taskList"] { @apply list-none ml-0 p-0; }
.post-content .ProseMirror ul[data-type="taskList"] li { @apply flex items-start gap-2; }
.post-content .ProseMirror ul[data-type="taskList"] li > label { @apply flex-shrink-0 mt-1 select-none mr-2; }
.post-content .ProseMirror ul[data-type="taskList"] li > div { @apply flex-auto; }

/* Table */
.post-content .ProseMirror table { @apply w-full my-8 border-collapse; }
.post-content .ProseMirror th { @apply bg-muted font-semibold text-left p-3 border border-border font-text; }
.post-content .ProseMirror td { @apply p-3 border border-border font-text; }

/* Drag handle */
.post-content :is(.tiptap-drag-handle, .drag-handle) {
  position: absolute;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 30px;
  height: 30px;
  border-radius: 8px;
  background: rgba(0,0,0,0.02);
  cursor: grab;
  transition: background-color .12s ease, transform .12s ease;
  z-index: 60;
}
.post-content :is(.tiptap-drag-handle:hover, .drag-handle:hover) { background: rgba(0,0,0,0.06); }

/* Horizontal card node */
.horizontal-card {
  @apply relative flex items-stretch gap-4 border-1.5 border-border rounded-xl p-3 md:p-4 bg-background;
}

.horizontal-card--image-right { @apply flex-row-reverse; }
.horizontal-card--image-left { @apply flex-row; }

.post-content .horizontal-card__media {
  @apply relative w-24 h-24 sm:w-28 sm:h-28 md:w-32 md:h-32 flex-shrink-0 overflow-hidden rounded-lg bg-muted flex items-center justify-center shadow-sm transition-shadow duration-300 ease-in-out;
}
.post-content .horizontal-card__media:hover { @apply shadow-xl; }
.post-content .horizontal-card__media:active { @apply shadow-none; }

.post-content .horizontal-card__image { @apply w-full h-full object-cover; }
.post-content .horizontal-card__image.is-square { @apply aspect-square; }

.post-content .horizontal-card__placeholder { @apply text-xs text-slate-500 dark:text-slate-400 text-center px-2; }

.horizontal-card__replace-btn {
  @apply absolute bottom-1 right-1 text-xs px-2 py-1 rounded-md bg-background/90 border border-border shadow-sm hover:bg-muted transition-colors;
}

.horizontal-card__revert-btn {
  @apply absolute top-1 right-1 text-xs px-2 py-1 rounded-md bg-background/90 border border-border shadow-sm hover:bg-muted transition-colors;
}

.post-content .horizontal-card__body { @apply flex-1 min-w-0; }

/* Auto link preview styles */
.post-content .ProseMirror .auto-link-preview { @apply relative flex items-start gap-4 border-1.5 border-border rounded-xl p-3 my-2 md:p-4 bg-background hover:scale-102 active:scale-99 transition-transform duration-200 ease-in; }
.dark .post-content .ProseMirror .auto-link-preview ::selection { @apply bg-transparent color-white; }
.post-content .ProseMirror .auto-link-preview a { @apply decoration-none color-inherit; }
.post-content .ProseMirror .auto-link-preview__media { @apply relative w-24 h-24 flex-shrink-0 overflow-hidden rounded-lg bg-muted flex items-center justify-center; }
.post-content .ProseMirror .auto-link-preview__image { @apply w-full h-full object-cover; }
.post-content .ProseMirror .auto-link-preview__placeholder { @apply text-xs text-slate-500 dark:text-slate-400; }
.post-content .ProseMirror .auto-link-preview__spinner { @apply absolute inset-0 flex items-center justify-center bg-background/40; }
.post-content .ProseMirror .spinner { @apply w-4 h-4 border-2 border-slate-300 border-t-transparent rounded-full animate-spin; }
.post-content .ProseMirror .auto-link-preview__meta { @apply flex-1; }
.post-content .ProseMirror .auto-link-preview__title { @apply font-title text-lg font-semibold mb-1 truncate mt-0; }
.post-content .ProseMirror .auto-link-preview__description { @apply text-xs text-slate-500 dark:text-slate-400; }
.post-content .ProseMirror .auto-link-preview__title-input { @apply w-full font-title text-lg font-semibold px-2 py-1 rounded mb-1 bg-background; }
.post-content .ProseMirror .auto-link-preview__desc-input { @apply w-full text-xs px-2 py-1 rounded bg-background; }
.post-content .ProseMirror .auto-link-preview__revert-btn { @apply absolute top-1 right-1 text-xs px-2 py-1 rounded-md bg-background/90 border border-border shadow-sm; }
.post-content .horizontal-card__text { @apply text-sm sm:text-base text-foreground leading-relaxed whitespace-pre-wrap; }
.post-content .horizontal-card__body h3 { @apply m-0; }
.post-content .horizontal-card__body p { @apply mb-0; }

.post-content .horizontal-card__toolbar { @apply flex items-center gap-2 mb-2; }
.post-content .horizontal-card__toolbar button { @apply px-2 py-1 rounded border border-border bg-background text-sm; }
.post-content .horizontal-card__toolbar button.is-active { @apply bg-primary text-white border-transparent; }
.post-content .horizontal-card__content { @apply focus:outline-none; }
.post-content .ProseMirror .auto-link-preview__media.is-clickable { cursor: pointer; }
.post-content .ProseMirror .auto-link-preview__meta.is-clickable { cursor: pointer; }
/* .horizontal-card__textarea removed in favor of rich content editing */

/* Menus */
.bubble-menu, .floating-menu, .link-popover { @apply bg-background border border-border rounded-lg shadow-lg flex items-center gap-1 p-1; }
.bubble-menu button, .floating-menu > button, .link-popover button { @apply p-1.5 rounded-md text-foreground/80 hover:bg-muted hover:text-primary transition-colors flex items-center justify-center min-w-[28px]; }
.bubble-menu button.is-active, .floating-menu > button.is-active, .link-popover button.is-active { @apply bg-primary/10 text-primary; }
.bubble-menu .divider, .link-popover .divider { @apply w-px h-5 bg-border mx-1; }
.drag-handle-dropdown .n-dropdown-menu__menu { z-index: 70; min-width: 200px; }
.drag-handle-dropdown .n-dropdown-menu__trigger { display: inline-flex; align-items: center; justify-content: center; padding: 0.25rem; }
.menu-block-type .n-dropdown-menu__trigger { @apply p-0 min-w-[120px]; }
